<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Coftea_Capstone.Views.Pages.Inventory"
             xmlns:view="clr-namespace:Coftea_Capstone.Views.Pages"
             xmlns:otherViews="clr-namespace:Coftea_Capstone.Views.Controls"
             Title="Inventory"
             BackgroundColor="#D6BCA8">

    <Grid ColumnDefinitions="200, *" RowDefinitions="*">
        <!-- Sidebar Navigation -->
        <view:NavigationBar Grid.Column="0"/>

        <!-- Main Content -->
        <Grid Grid.Column="1" Padding="20" RowDefinitions="Auto,*">

            <VerticalStackLayout Padding="0" Spacing="20">

                <!-- Top Bar -->
                <Grid ColumnDefinitions="*, Auto, Auto, Auto" VerticalOptions="Center" ColumnSpacing="25">
                    <Label Text="Inventory" FontSize="32" FontAttributes="Bold" VerticalOptions="Center"/>
                    <ImageButton Source="settings.png" Grid.Column="2" WidthRequest="30" HeightRequest="30" Command="{Binding ShowSettingsPopupCommand}"/>
                    <ImageButton Source="usericon.png" Grid.Column="3" WidthRequest="40" HeightRequest="40"/>
                </Grid>

                <!-- Brownish Frame with Controls and CollectionView -->
                <Frame BackgroundColor="#7E6D5F" CornerRadius="15" Padding="20" HasShadow="False">

                    <VerticalStackLayout Spacing="15">

                        <!-- Top Controls: Category Buttons, Sort By, Search -->
                        <HorizontalStackLayout Spacing="15" VerticalOptions="Center">

                            <!-- Category Buttons -->
                            <Button Text="Addons" TextColor="Black" FontAttributes="Bold" BackgroundColor="#D9D9D9" WidthRequest="120" HeightRequest="40" CornerRadius="7"/>
                            <Button Text="Ingredients" TextColor="Black" FontAttributes="Bold" BackgroundColor="#D9D9D9" WidthRequest="120" HeightRequest="40" CornerRadius="7"/>
                            <Button Text="Supplies" TextColor="Black" FontAttributes="Bold" BackgroundColor="#D9D9D9" WidthRequest="120" HeightRequest="40" CornerRadius="7"/>

                            <!-- Sort By Picker -->
                            <Frame CornerRadius="10" BackgroundColor="White" Padding="5" WidthRequest="180" HeightRequest="40">
                                <Picker Title="Sort By" VerticalOptions="Center" >
                                    <Picker.Items>
                                        <x:String>Name (A-Z)</x:String>
                                        <x:String>Name (Z-A)</x:String>
                                        <x:String>Price (Low to High)</x:String>
                                        <x:String>Price (High to Low)</x:String>
                                    </Picker.Items>
                                </Picker>
                            </Frame>

                            <!-- Search Bar -->
                            <SearchBar Placeholder="Search for something" WidthRequest="250" HeightRequest="40" BackgroundColor="White"/>
                        </HorizontalStackLayout>

                        <!-- Inventory CollectionView -->
                        <CollectionView x:Name="InventoryCollectionView" ItemsLayout="VerticalList" BackgroundColor="Transparent" Margin="0,10,0,0">
                            <CollectionView.Header>
                                <!-- Header Row -->
                                <Grid ColumnDefinitions="1*, 1*, 2*" BackgroundColor="#DAAB97" Padding="15">
                                    <Label Text="Name" FontSize="15" FontAttributes="Bold" VerticalOptions="Center" HorizontalOptions="Center"/>
                                    <Label Text="Category" FontSize="15" FontAttributes="Bold" VerticalOptions="Center" HorizontalOptions="Center" Grid.Column="1"/>
                                    <Label Text="Stocks" FontSize="15" FontAttributes="Bold" VerticalOptions="Center" HorizontalOptions="Center" Grid.Column="2"/>
                                </Grid>
                            </CollectionView.Header>
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Frame Padding="10" Margin="0,5,0,5" CornerRadius="10" BackgroundColor="White">
                                        <Grid ColumnDefinitions="2*, 1*, 1*" VerticalOptions="Center">
                                            <!-- Name -->
                                            <Label Text="{Binding ItemName}" Grid.Column="0" VerticalOptions="Center"/>
                                            <!-- Category -->
                                            <Label Text="{Binding Category}" Grid.Column="1" VerticalOptions="Center" HorizontalOptions="Center"/>
                                            <!-- Stocks -->
                                            <Label Text="{Binding Stocks}" Grid.Column="2" VerticalOptions="Center" HorizontalOptions="Center"/>
                                        </Grid>
                                    </Frame>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>

                        <!-- Edit / Add Buttons -->
                        <HorizontalStackLayout Spacing="20" HorizontalOptions="End">
                            <Button Text="Edit" TextColor="Black" FontAttributes="Bold" WidthRequest="80" BackgroundColor="#FFDD02"/>
                            <Button Text="Add" TextColor="Black" FontAttributes="Bold" WidthRequest="80" BackgroundColor="#07AE37"/>
                        </HorizontalStackLayout>

                    </VerticalStackLayout>

                </Frame>

            </VerticalStackLayout>
        </Grid>
        
        <!-- Settings Popup -->
        <view:Settings BindingContext="{Binding .}" Grid.ColumnSpan="2"/>
        
        <!-- Manage POS Options Popup -->
        <otherViews:ManagePOSOptions BindingContext="{Binding Source={x:Static Application.Current}, Path=ManagePOSPopup}" Grid.ColumnSpan="2"/>
        <otherViews:EditProductPopup BindingContext="{Binding Source={x:Static Application.Current}, Path=ManagePOSPopup.EditProductPopupVM}" Grid.ColumnSpan="2"/>
        
        <!-- Manage Inventory Options Popup -->
        <otherViews:ManageInventoryOptions BindingContext="{Binding Source={x:Static Application.Current}, Path=ManageInventoryPopup}" Grid.ColumnSpan="2"/>
        <otherViews:AddItemToInventory BindingContext="{Binding Source={x:Static Application.Current}, Path=ManageInventoryPopup.AddItemToInventoryVM}" Grid.ColumnSpan="2"/>
    </Grid>
</ContentPage>
