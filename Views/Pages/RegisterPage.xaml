<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Coftea_Capstone.Views.Pages.RegisterPage"
             xmlns:vm="clr-namespace:Coftea_Capstone.ViewModel"
             xmlns:otherViews="clr-namespace:Coftea_Capstone.Views.Controls"
             xmlns:sys="clr-namespace:System;assembly=System.Runtime"
             xmlns:converters="clr-namespace:Coftea_Capstone.ViewModel.Others"
             Shell.NavBarIsVisible="False"
             >

    <ContentPage.Resources>
        <ResourceDictionary>
            <converters:BoolToColorConverter x:Key="BoolToColorConverter" />
        </ResourceDictionary>
    </ContentPage.Resources>

    <ContentPage.BindingContext>
        <vm:RegisterPageViewModel/>
    </ContentPage.BindingContext>

    <!-- Background Gradient -->
    <ContentPage.Background>
        <LinearGradientBrush>
            <GradientStop Color="#C1A892" Offset="0.25" />
            <GradientStop Color="#5B4F45" Offset="0.85" /> 
        </LinearGradientBrush>
    </ContentPage.Background>

    <!-- Main Grid containing all content -->
    <Grid>
        <ScrollView VerticalOptions="Center" HorizontalOptions="Center" 
                   Orientation="Both" 
                   VerticalScrollBarVisibility="Default"
                   HorizontalScrollBarVisibility="Default">
            <VerticalStackLayout HorizontalOptions="Center" VerticalOptions="Center" Spacing="25">
                
<<<<<<< Updated upstream
                <!-- Logo and Welcome Section -->
                <StackLayout HorizontalOptions="Center" Spacing="20">
=======
                <!-- Left Frame: Registration Form -->
                <Frame BackgroundColor="#BDAEA2"
                       Padding="25,60,25,25"
                       CornerRadius="0"
                       BorderColor="#8B7355"
                       HasShadow="True"
                       WidthRequest="420"
                       HeightRequest="620">

                    <ScrollView Orientation="Vertical" VerticalScrollBarVisibility="Default">
                        <VerticalStackLayout Spacing="12">
                            <!-- First Row: Name Fields -->
                            <HorizontalStackLayout Spacing="10">
                                <Border Stroke="#8B7355" StrokeShape="RoundRectangle 15" StrokeThickness="2" HeightRequest="55" WidthRequest="179" BackgroundColor="#F5F1ED">
                                    <Entry Placeholder="First Name" 
                                           PlaceholderColor="#8B7355" 
                                           TextColor="#5B4F45"
                                           FontFamily="MontserratBlack"
                                           FontSize="16"
                                           Margin="20,0"
                                           Text="{Binding FirstName}"/>
                                </Border>
                                <Border Stroke="#8B7355" StrokeShape="RoundRectangle 15" StrokeThickness="2" HeightRequest="55" WidthRequest="179" BackgroundColor="#F5F1ED">
                                    <Entry Placeholder="Last Name" 
                                           PlaceholderColor="#8B7355" 
                                           TextColor="#5B4F45"
                                           FontFamily="MontserratBlack"
                                           FontSize="16"
                                           Margin="20,0"
                                           Text="{Binding LastName}" />
                                </Border>
                            </HorizontalStackLayout>

                            <!-- Second Row: Email -->
                            <Border Stroke="#8B7355" StrokeShape="RoundRectangle 15" StrokeThickness="2" HeightRequest="55" WidthRequest="370" Margin="15" BackgroundColor="#F5F1ED">
                                <Entry Placeholder="Enter Email" 
                                       Keyboard="Email" 
                                       PlaceholderColor="#8B7355" 
                                       TextColor="#5B4F45"
                                       FontFamily="MontserratBlack"
                                       FontSize="16"
                                       Margin="20,0"
                                       Text="{Binding Email}"/>
                            </Border>
                                        
                            <!-- Third Row: Password -->
                            <Border Stroke="#8B7355" StrokeShape="RoundRectangle 15" StrokeThickness="2" HeightRequest="55" WidthRequest="370" BackgroundColor="#F5F1ED">
                                <Grid>
                                    <Entry x:Name="RegisterPasswordEntry" 
                                           Placeholder="Enter Password" 
                                           IsPassword="True" 
                                           PlaceholderColor="#8B7355" 
                                           TextColor="#5B4F45"
                                           FontFamily="MontserratBlack"
                                           FontSize="16"
                                           Margin="20,0,60,0"
                                           Text="{Binding Password}"/>
                                    <ImageButton Source="show.png"
                                                WidthRequest="28"
                                                HeightRequest="28"
                                                Padding="0"
                                                BackgroundColor="Transparent"
                                                HorizontalOptions="End"
                                                VerticalOptions="Center"
                                                Margin="0,0,20,0"
                                                Clicked="OnToggleRegisterPasswordVisibility" />
                                </Grid>
                            </Border>

                            <!-- Password Requirements -->
                            <StackLayout Spacing="6" Margin="15,5,15,0" BackgroundColor="#F5F1ED" Padding="20,12" >
                                <Label Text="Password Requirements:" FontSize="14" TextColor="#5B4F45" FontFamily="MontserratBlack"/>
                                <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto,Auto" ColumnSpacing="20" RowSpacing="8">
                                    <StackLayout Grid.Row="0" Grid.Column="0" Orientation="Horizontal" Spacing="6">
                                        <Label Text="✓" TextColor="{Binding HasUppercase, Converter={StaticResource BoolToColorConverter}}" FontSize="14" FontFamily="MontserratBlack"/>
                                        <Label Text="Uppercase" FontSize="13" TextColor="#8B7355" FontFamily="MontserratBlack"/>
                                    </StackLayout>
                                    
                                    <StackLayout Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Spacing="6">
                                        <Label Text="✓" TextColor="{Binding HasLowercase, Converter={StaticResource BoolToColorConverter}}" FontSize="14" FontFamily="MontserratBlack"/>
                                        <Label Text="Lowercase" FontSize="13" TextColor="#8B7355" FontFamily="MontserratBlack"/>
                                    </StackLayout>
                                    
                                    <StackLayout Grid.Row="1" Grid.Column="0" Orientation="Horizontal" Spacing="6">
                                        <Label Text="✓" TextColor="{Binding HasNumber, Converter={StaticResource BoolToColorConverter}}" FontSize="14" FontFamily="MontserratBlack"/>
                                        <Label Text="0-9" FontSize="13" TextColor="#8B7355" FontFamily="MontserratBlack"/>
                                    </StackLayout>
                                    
                                    <StackLayout Grid.Row="1" Grid.Column="1" Orientation="Horizontal" Spacing="6">
                                        <Label Text="✓" TextColor="{Binding HasSpecialChar, Converter={StaticResource BoolToColorConverter}}" FontSize="14" FontFamily="MontserratBlack"/>
                                        <Label Text="Special character" FontSize="13" TextColor="#8B7355" FontFamily="MontserratBlack"/>
                                    </StackLayout>
                                    
                                    <StackLayout Grid.Row="2" Grid.Column="0" Orientation="Horizontal" Spacing="6">
                                        <Label Text="✓" TextColor="{Binding HasMinLength, Converter={StaticResource BoolToColorConverter}}" FontSize="14" FontFamily="MontserratBlack"/>
                                        <Label Text="At least 8 characters long" FontSize="13" TextColor="#8B7355" FontFamily="MontserratBlack"/>
                                    </StackLayout>
                                </Grid>
                            </StackLayout>

                            <!-- Fourth Row: Confirm Password -->
                            <Border Stroke="#8B7355" StrokeShape="RoundRectangle 15" StrokeThickness="2" HeightRequest="55" WidthRequest="370" BackgroundColor="#F5F1ED">
                                <Grid>
                                    <Entry x:Name="RegisterConfirmPasswordEntry" 
                                           Placeholder="Confirm Password" 
                                           IsPassword="True" 
                                           PlaceholderColor="#8B7355" 
                                           TextColor="#5B4F45"
                                           FontFamily="MontserratBlack"
                                           FontSize="16"
                                           Margin="20,0,60,0"
                                           Text="{Binding ConfirmPassword}"/>
                                    <ImageButton Source="show.png"
                                                WidthRequest="28"
                                                HeightRequest="28"
                                                Padding="0"
                                                BackgroundColor="Transparent"
                                                HorizontalOptions="End"
                                                VerticalOptions="Center"
                                                Margin="0,0,20,0"
                                                Clicked="OnToggleRegisterConfirmPasswordVisibility" />
                                </Grid>
                            </Border>

                            <!-- Password Match Indicator -->
                            <StackLayout Orientation="Horizontal" Spacing="8" Margin="15,5,15,0" BackgroundColor="#F5F1ED" Padding="20,10" >
                                <Label Text="✓" TextColor="{Binding PasswordsMatch, Converter={StaticResource BoolToColorConverter}}" FontSize="14" FontFamily="MontserratBlack"/>
                                <Label Text="Passwords match" FontSize="13" TextColor="#8B7355" FontFamily="MontserratBlack"/>
                            </StackLayout>

                            <!-- Fifth Row: Phone Number -->
                            <Border Stroke="#8B7355" StrokeShape="RoundRectangle 15" StrokeThickness="2" HeightRequest="55" WidthRequest="370" BackgroundColor="#F5F1ED">
                                <Entry Placeholder="Phone Number" 
                                       Keyboard="Telephone" 
                                       PlaceholderColor="#8B7355" 
                                       TextColor="#5B4F45"
                                       FontFamily="MontserratBlack"
                                       FontSize="16"
                                       Margin="20,0"
                                       Text="{Binding PhoneNumber}" />
                            </Border>

                            <!-- Seventh Row: Address -->
                            <Border Stroke="#8B7355" StrokeShape="RoundRectangle 15" StrokeThickness="2" HeightRequest="55" WidthRequest="370" BackgroundColor="#F5F1ED">
                                <Entry Placeholder="Address" 
                                       PlaceholderColor="#8B7355" 
                                       TextColor="#5B4F45"
                                       FontFamily="MontserratBlack"
                                       FontSize="16"
                                       Margin="20,0"
                                       Text="{Binding Address}"/>
                            </Border>

                            <!-- Terms & Conditions -->
                            <HorizontalStackLayout Spacing="10" Margin="15,15,15,20" HorizontalOptions="Start">
                                <CheckBox IsChecked="{Binding IsTermsAccepted}" Color="#5B4F45" Scale="1.2"/>
                                <Label Text="I agree to the " 
                                       VerticalOptions="Center" 
                                       TextColor="#5B4F45"
                                       FontFamily="MontserratBlack"
                                       FontSize="15"/>
                                <Label Text="Terms and Conditions" 
                                       TextColor="#8B7355" 
                                       VerticalOptions="Center"
                                       FontFamily="MontserratBlack"
                                       FontSize="15"/>
                            </HorizontalStackLayout>
                            
                            <!-- Action Buttons -->
                            <Grid ColumnDefinitions="*,*" ColumnSpacing="20" RowDefinitions="Auto" Margin="15,0,15,0">
                                <Button Grid.Column="0" 
                                        Text="← Back to Login" 
                                        BackgroundColor="#C1A892" 
                                        TextColor="#5B4F45" 
                                        FontSize="16"
                                        FontFamily="MontserratBlack"
                                        Command="{Binding BackToLoginCommand}"
                                        CornerRadius="15"
                                        Padding="30,15"
                                        BorderColor="#8B7355"
                                        BorderWidth="2"
                                        HeightRequest="55"/>
                                <Button Grid.Column="1" 
                                        Text="Register"
                                        BackgroundColor="#5B4F45"
                                        TextColor="White"
                                        FontSize="16"
                                        FontFamily="MontserratBlack"
                                        Command="{Binding RegisterCommand}"
                                        CornerRadius="15"
                                        Padding="30,15"
                                        HeightRequest="55"/>
                            </Grid>
                        </VerticalStackLayout>
                    </ScrollView>
                </Frame>

                <!-- Right Frame: Logo -->
                <Frame BackgroundColor="#C0BBB6"
                       Padding="45,0,45,0"
                       CornerRadius="0"
                       HasShadow="False"
                       WidthRequest="420"
                       HeightRequest="620">

>>>>>>> Stashed changes
                    <Image Source="coftea_logo.png"
                           HeightRequest="180"
                           HorizontalOptions="Center"/>
                    <Label Text="Welcome to Coftea" 
                           FontSize="32" 
                           FontFamily="Montserrat-Black" 
                           TextColor="#5B4F45" 
                           HorizontalOptions="Center"/>
                </StackLayout>

            <!-- Registration Form -->
            <Frame BackgroundColor="#BDAEA2"
                   Padding="35,35,35,35"
                   CornerRadius="20"
                   BorderColor="#8B7355"
                   HasShadow="True"
                   WidthRequest="500"
                   MinimumHeightRequest="500">

                <VerticalStackLayout Spacing="20">
                    <!-- Title -->
                    <Label Text="Create Account" 
                           FontSize="28" 
                           FontFamily="Montserrat-Black" 
                           TextColor="#5B4F45" 
                           HorizontalOptions="Center" 
                           Margin="0,0,0,20"/>
                    
                    <!-- First Row: Name Fields -->
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="20" RowDefinitions="Auto">
                        <Border Grid.Column="0" Stroke="#8B7355" StrokeShape="RoundRectangle 15" StrokeThickness="2" HeightRequest="55" BackgroundColor="#F5F1ED">
                            <Entry Placeholder="First Name" 
                                   PlaceholderColor="#8B7355" 
                                   TextColor="#5B4F45"
                                   FontFamily="OpenSans-Regular"
                                   FontSize="16"
                                   Margin="20,0"
                                   Text="{Binding FirstName}"/>
                        </Border>
                        <Border Grid.Column="1" Stroke="#8B7355" StrokeShape="RoundRectangle 15" StrokeThickness="2" HeightRequest="55" BackgroundColor="#F5F1ED">
                            <Entry Placeholder="Last Name" 
                                   PlaceholderColor="#8B7355" 
                                   TextColor="#5B4F45"
                                   FontFamily="OpenSans-Regular"
                                   FontSize="16"
                                   Margin="20,0"
                                   Text="{Binding LastName}" />
                        </Border>
                    </Grid>

                    <!-- Second Row: Email -->
                    <Border Stroke="#8B7355" StrokeShape="RoundRectangle 15" StrokeThickness="2" HeightRequest="55" BackgroundColor="#F5F1ED">
                        <Entry Placeholder="Enter Email" 
                               Keyboard="Email" 
                               PlaceholderColor="#8B7355" 
                               TextColor="#5B4F45"
                               FontFamily="OpenSans-Regular"
                               FontSize="16"
                               Margin="20,0"
                               Text="{Binding Email}"/>
                    </Border>
                                
                    <!-- Third Row: Password -->
                    <Border Stroke="#8B7355" StrokeShape="RoundRectangle 15" StrokeThickness="2" HeightRequest="55" BackgroundColor="#F5F1ED">
                        <Grid>
                            <Entry x:Name="RegisterPasswordEntry" 
                                   Placeholder="Enter Password" 
                                   IsPassword="True" 
                                   PlaceholderColor="#8B7355" 
                                   TextColor="#5B4F45"
                                   FontFamily="OpenSans-Regular"
                                   FontSize="16"
                                   Margin="20,0,60,0"
                                   Text="{Binding Password}"/>
                            <ImageButton Source="show.png"
                                        WidthRequest="28"
                                        HeightRequest="28"
                                        Padding="0"
                                        BackgroundColor="Transparent"
                                        HorizontalOptions="End"
                                        VerticalOptions="Center"
                                        Margin="0,0,20,0"
                                        Clicked="OnToggleRegisterPasswordVisibility" />
                        </Grid>
                    </Border>

                    <!-- Password Requirements - Descriptive Words -->
                    <StackLayout Spacing="6" Margin="0,5,0,0" BackgroundColor="#F5F1ED" Padding="20,12" >
                        <Label Text="Password Requirements:" FontSize="14" TextColor="#5B4F45" FontFamily="OpenSans-Semibold"/>
                        <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto,Auto" ColumnSpacing="20" RowSpacing="8">
                            <StackLayout Grid.Row="0" Grid.Column="0" Orientation="Horizontal" Spacing="6">
                                <Label Text="✓" TextColor="{Binding HasUppercase, Converter={StaticResource BoolToColorConverter}}" FontSize="14" FontFamily="OpenSans-Semibold"/>
                                <Label Text="Uppercase" FontSize="13" TextColor="#8B7355" FontFamily="OpenSans-Regular"/>
                            </StackLayout>
                            
                            <StackLayout Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Spacing="6">
                                <Label Text="✓" TextColor="{Binding HasLowercase, Converter={StaticResource BoolToColorConverter}}" FontSize="14" FontFamily="OpenSans-Semibold"/>
                                <Label Text="Lowercase" FontSize="13" TextColor="#8B7355" FontFamily="OpenSans-Regular"/>
                            </StackLayout>
                            
                            <StackLayout Grid.Row="1" Grid.Column="0" Orientation="Horizontal" Spacing="6">
                                <Label Text="✓" TextColor="{Binding HasNumber, Converter={StaticResource BoolToColorConverter}}" FontSize="14" FontFamily="OpenSans-Semibold"/>
                                <Label Text="0-9" FontSize="13" TextColor="#8B7355" FontFamily="OpenSans-Regular"/>
                            </StackLayout>
                            
                            <StackLayout Grid.Row="1" Grid.Column="1" Orientation="Horizontal" Spacing="6">
                                <Label Text="✓" TextColor="{Binding HasSpecialChar, Converter={StaticResource BoolToColorConverter}}" FontSize="14" FontFamily="OpenSans-Semibold"/>
                                <Label Text="Special character" FontSize="13" TextColor="#8B7355" FontFamily="OpenSans-Regular"/>
                            </StackLayout>
                            
                            <StackLayout Grid.Row="2" Grid.Column="0" Orientation="Horizontal" Spacing="6">
                                <Label Text="✓" TextColor="{Binding HasMinLength, Converter={StaticResource BoolToColorConverter}}" FontSize="14" FontFamily="OpenSans-Semibold"/>
                                <Label Text="At least 8 characters long" FontSize="13" TextColor="#8B7355" FontFamily="OpenSans-Regular"/>
                            </StackLayout>
                        </Grid>
                    </StackLayout>

                    <!-- Fourth Row: Confirm Password -->
                    <Border Stroke="#8B7355" StrokeShape="RoundRectangle 15" StrokeThickness="2" HeightRequest="55" BackgroundColor="#F5F1ED">
                        <Grid>
                            <Entry x:Name="RegisterConfirmPasswordEntry" 
                                   Placeholder="Confirm Password" 
                                   IsPassword="True" 
                                   PlaceholderColor="#8B7355" 
                                   TextColor="#5B4F45"
                                   FontFamily="OpenSans-Regular"
                                   FontSize="16"
                                   Margin="20,0,60,0"
                                   Text="{Binding ConfirmPassword}"/>
                            <ImageButton Source="show.png"
                                        WidthRequest="28"
                                        HeightRequest="28"
                                        Padding="0"
                                        BackgroundColor="Transparent"
                                        HorizontalOptions="End"
                                        VerticalOptions="Center"
                                        Margin="0,0,20,0"
                                        Clicked="OnToggleRegisterConfirmPasswordVisibility" />
                        </Grid>
                    </Border>

                    <!-- Password Match Indicator -->
                    <StackLayout Orientation="Horizontal" Spacing="8" Margin="0,5,0,0" BackgroundColor="#F5F1ED" Padding="20,10" >
                        <Label Text="✓" TextColor="{Binding PasswordsMatch, Converter={StaticResource BoolToColorConverter}}" FontSize="14" FontFamily="OpenSans-Semibold"/>
                        <Label Text="Passwords match" FontSize="13" TextColor="#8B7355" FontFamily="OpenSans-Regular"/>
                    </StackLayout>

                    <!-- Fifth Row: Phone Number -->
                    <Border Stroke="#8B7355" StrokeShape="RoundRectangle 15" StrokeThickness="2" HeightRequest="55" BackgroundColor="#F5F1ED">
                        <Entry Placeholder="Phone Number" 
                               Keyboard="Telephone" 
                               PlaceholderColor="#8B7355" 
                               TextColor="#5B4F45"
                               FontFamily="OpenSans-Regular"
                               FontSize="16"
                               Margin="20,0"
                               Text="{Binding PhoneNumber}" />
                    </Border>
                    <!-- Terms & Conditions -->
                    <HorizontalStackLayout Spacing="10" Margin="0,15,0,20" HorizontalOptions="Center">
                        <CheckBox IsChecked="{Binding IsTermsAccepted}" Color="#5B4F45" Scale="1.2"/>
                        <Label Text="I agree to the " 
                               VerticalOptions="Center" 
                               TextColor="#5B4F45"
                               FontFamily="OpenSans-Regular"
                               FontSize="15"/>
                        <Label Text="Terms and Conditions" 
                               TextColor="#8B7355" 
                               VerticalOptions="Center"
                               FontFamily="OpenSans-Semibold"
                               FontSize="15"/>
                    </HorizontalStackLayout>
                    
                    <!-- Action Buttons -->
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="20" RowDefinitions="Auto">
                        <Button Grid.Column="0" 
                                Text="← Back to Login" 
                                BackgroundColor="#C1A892" 
                                TextColor="#5B4F45" 
                                FontSize="16"
                                FontFamily="OpenSans-Semibold"
                                Command="{Binding BackToLoginCommand}"
                                CornerRadius="15"
                                Padding="30,15"
                                BorderColor="#8B7355"
                                BorderWidth="2"
                                HeightRequest="55"/>
                        <Button Grid.Column="1" 
                                Text="Register"
                                BackgroundColor="#5B4F45"
                                TextColor="White"
                                FontSize="16"
                                FontFamily="OpenSans-Semibold"
                                Command="{Binding RegisterCommand}"
                                CornerRadius="15"
                                Padding="30,15"
                                HeightRequest="55"/>
                    </Grid>
                </VerticalStackLayout>
            </Frame>
            </VerticalStackLayout>
        </ScrollView>

        <!-- Retry Connection Popup - Overlay at root level -->
        <otherViews:RetryConnectionPopup x:Name="RetryConnectionPopup" 
                                         Grid.RowSpan="1" 
                                         Grid.ColumnSpan="1" />
    </Grid>
</ContentPage>