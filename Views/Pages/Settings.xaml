<ContentView
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="Coftea_Capstone.Views.Pages.Settings"
    BackgroundColor="#80000000"
    x:Name="SettingsPop"
    IsVisible="{Binding IsSettingsPopupVisible}"
    InputTransparent="False">

    <Grid VerticalOptions="Fill" HorizontalOptions="Fill" InputTransparent="False">
        <!-- Tap outside to close -->
        <Grid.GestureRecognizers>
            <TapGestureRecognizer Command="{Binding CloseSettingsPopupCommand}" />
        </Grid.GestureRecognizers>

        <!-- Main Popup Frame -->
        <Frame
            VerticalOptions="Center"
            HorizontalOptions="Center"
            Padding="25"
            BackgroundColor="#FFF9F4"
            CornerRadius="25"
            HasShadow="True"
            WidthRequest="580"
            HeightRequest="650"
            InputTransparent="False">

            <Frame.GestureRecognizers>
                <TapGestureRecognizer Tapped="OnFrameTapped" />
            </Frame.GestureRecognizers>

            <ScrollView>
                <VerticalStackLayout Spacing="20">
                <!-- Header -->
                <Label Text="Settings"
                       FontSize="26"
                       FontAttributes="Bold"
                       TextColor="#4B3832"
                       HorizontalOptions="Center" />

                <!-- 2x2 Grid for buttons -->
                <Grid RowDefinitions="*,*"
                      ColumnDefinitions="*,*"
                      ColumnSpacing="25"
                      RowSpacing="25"
                      HorizontalOptions="Center"
                      VerticalOptions="Center">

                    <!-- Row 0, Column 0 -->
                    <VerticalStackLayout Grid.Row="0" Grid.Column="0" HorizontalOptions="Center" Spacing="10">
                        <Frame CornerRadius="15" HasShadow="True" BackgroundColor="#DCC3A6">
                            <ImageButton Source="usermanagementicon.png"
                                         BackgroundColor="Transparent"
                                         HeightRequest="90"
                                         WidthRequest="90"
                                         Command="{Binding OpenUserManagementCommand}" />
                        </Frame>
                        <Label Text="User Management"
                               HorizontalOptions="Center"
                               FontSize="15"
                               FontAttributes="Bold"
                               TextColor="#4B3832"/>
                    </VerticalStackLayout>

                    <!-- Row 0, Column 1 -->
                    <VerticalStackLayout Grid.Row="0" Grid.Column="1" HorizontalOptions="Center" Spacing="10">
                        <Frame CornerRadius="15" HasShadow="True" BackgroundColor="#DCC3A6">
                            <ImageButton Source="manageposicon.png"
                                         BackgroundColor="Transparent"
                                         HeightRequest="90"
                                         WidthRequest="90"
                                         Command="{Binding OpenManagePOSOptionsCommand}" />
                        </Frame>
                        <Label Text="Manage POS Menu"
                               HorizontalOptions="Center"
                               FontSize="15"
                               FontAttributes="Bold"
                               TextColor="#4B3832"/>
                    </VerticalStackLayout>

                    <!-- Row 1, Column 0 -->
                    <VerticalStackLayout Grid.Row="1" Grid.Column="0" HorizontalOptions="Center" Spacing="10">
                        <Frame CornerRadius="15" HasShadow="True" BackgroundColor="#DCC3A6">
                            <ImageButton Source="manageinventoryicon.png"
                                         BackgroundColor="Transparent"
                                         HeightRequest="90"
                                         WidthRequest="90"
                                         Command="{Binding OpenManageInventoryOptionsCommand}" />
                        </Frame>
                        <Label Text="Manage Inventory"
                               HorizontalOptions="Center"
                               FontSize="15"
                               FontAttributes="Bold"
                               TextColor="#4B3832"/>
                    </VerticalStackLayout>

                    <!-- Row 1, Column 1 -->
                    <VerticalStackLayout Grid.Row="1" Grid.Column="1" HorizontalOptions="Center" Spacing="10">
                        <Frame CornerRadius="15" HasShadow="True" BackgroundColor="#F28C8C">
                            <ImageButton Source="logouticon.png"
                                         BackgroundColor="Transparent"
                                         HeightRequest="90"
                                         WidthRequest="90"
                                         Command="{Binding LogoutCommand}" />
                        </Frame>
                        <Label Text="Logout"
                               HorizontalOptions="Center"
                               FontSize="15"
                               FontAttributes="Bold"
                               TextColor="#4B3832"/>
                    </VerticalStackLayout>

                </Grid>

                <!-- Database IP Setting Section -->
                <Frame BackgroundColor="#F0F0F0" CornerRadius="15" Padding="15" Margin="0,10,0,0">
                    <VerticalStackLayout Spacing="10">
                        <Label Text="Database Connection" FontSize="16" FontAttributes="Bold" TextColor="#4B3832" HorizontalOptions="Center"/>
                        <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="10" VerticalOptions="Center">
                            <Label Text="IP:" FontSize="14" TextColor="#4B3832" VerticalOptions="Center"/>
                            <Entry Text="{Binding DatabaseIP}" 
                                   Placeholder="192.168.1.xxx" 
                                   FontSize="14" 
                                   BackgroundColor="White"
                                   Grid.Column="1"/>
                            <Button Text="Save" 
                                    Command="{Binding SaveDatabaseIPCommand}"
                                    BackgroundColor="#4CAF50" 
                                    TextColor="White" 
                                    FontSize="12"
                                    CornerRadius="10"
                                    WidthRequest="60"
                                    HeightRequest="35"
                                    Grid.Column="2"/>
                        </Grid>
                        <Label Text="Enter the PC's IP address where the database is running" 
                               FontSize="12" 
                               TextColor="Gray" 
                               HorizontalOptions="Center"/>
                    </VerticalStackLayout>
                </Frame>

                <!-- Database Backup Section -->
                <Frame BackgroundColor="#E8F5E8" CornerRadius="15" Padding="15" Margin="0,10,0,0">
                    <VerticalStackLayout Spacing="10">
                        <Label Text="Database Backup" FontSize="16" FontAttributes="Bold" TextColor="#4B3832" HorizontalOptions="Center"/>
                        <Grid ColumnDefinitions="*,*" ColumnSpacing="10" VerticalOptions="Center">
                            <Button Text="Create Backup" 
                                    Command="{Binding CreateBackupCommand}"
                                    BackgroundColor="#2196F3" 
                                    TextColor="White" 
                                    FontSize="14"
                                    CornerRadius="10"
                                    HeightRequest="40"/>
                            <Button Text="Restore Backup" 
                                    Command="{Binding RestoreBackupCommand}"
                                    BackgroundColor="#FF9800" 
                                    TextColor="White" 
                                    FontSize="14"
                                    CornerRadius="10"
                                    HeightRequest="40"/>
                        </Grid>
                        <Label Text="Backup your database to local storage for safety" 
                               FontSize="12" 
                               TextColor="Gray" 
                               HorizontalOptions="Center"/>
                    </VerticalStackLayout>
                </Frame>

                <!-- Close button at bottom -->
                <Button Text="Close"
                        Margin="0,15,0,0"
                        WidthRequest="100"
                        HeightRequest="45"
                        BackgroundColor="#F28C8C"
                        TextColor="White"
                        FontAttributes="Bold"
                        CornerRadius="20"
                        HorizontalOptions="Center"
                        Command="{Binding CloseSettingsPopupCommand}"/>
                </VerticalStackLayout>
            </ScrollView>
        </Frame>
    </Grid>
</ContentView>
