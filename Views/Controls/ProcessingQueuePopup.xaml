<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Coftea_Capstone.Views.Controls.ProcessingQueuePopup"
             x:Name="Root"
             IsVisible="{Binding IsVisible}"
             BackgroundColor="#80000000">
    <Grid HorizontalOptions="Center" VerticalOptions="Center" Padding="30">
        <Frame BackgroundColor="White" CornerRadius="24" Padding="0" HasShadow="True"
               WidthRequest="750" MaximumHeightRequest="800"
               HorizontalOptions="Center" VerticalOptions="Center">
            <Grid RowDefinitions="Auto,*" RowSpacing="0">
                <!-- Header -->
                <Grid Grid.Row="0" BackgroundColor="#5B4F45" Padding="20,15" ColumnDefinitions="*,Auto">
                    <Label Text="ðŸ“‹ To Prepare" FontAttributes="Bold" FontSize="18" TextColor="White" VerticalOptions="Center"/>
                    <Button Grid.Column="1" Text="âœ•" FontSize="18" BackgroundColor="Transparent" TextColor="White" 
                            Command="{Binding CloseCommand}" WidthRequest="35" HeightRequest="35" Padding="0"/>
                </Grid>
                
                <!-- Items List -->
                <CollectionView Grid.Row="1" ItemsSource="{Binding PendingItems}" MaximumHeightRequest="700" Margin="0">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Frame BackgroundColor="#FAFAFA" HasShadow="False" Padding="20,15" Margin="0,0,0,8" BorderColor="#E0E0E0">
                                <Grid ColumnDefinitions="*,Auto" RowSpacing="8">
                                    <!-- Item Info -->
                                    <VerticalStackLayout Grid.Column="0" Spacing="6">
                                        <!-- Product Name and Size Header -->
                                        <StackLayout Orientation="Horizontal" Spacing="8">
                                            <Label Text="{Binding ProductName}" FontAttributes="Bold" FontSize="15" TextColor="#2B2B2B"/>
                                            <Label Text="{Binding SizeDisplay}" FontSize="13" TextColor="#666" VerticalOptions="Center" FontAttributes="Bold"/>
                                            <Label Text="{Binding Quantity, StringFormat='x{0}'}" FontSize="12" TextColor="#666" FontAttributes="Bold" VerticalOptions="Center"/>
                                        </StackLayout>
                                        
                                        <!-- Ingredients List -->
                                        <VerticalStackLayout Spacing="3" Margin="15,5,0,0">
                                            <CollectionView ItemsSource="{Binding Ingredients}">
                                                <CollectionView.ItemTemplate>
                                                    <DataTemplate>
                                                        <Label FontSize="12" TextColor="#444" Margin="0,1,0,1">
                                                            <Label.Text>
                                                                <MultiBinding StringFormat="- {0}: {1} {2}">
                                                                    <Binding Path="IngredientName"/>
                                                                    <Binding Path="Amount"/>
                                                                    <Binding Path="Unit"/>
                                                                </MultiBinding>
                                                            </Label.Text>
                                                        </Label>
                                                    </DataTemplate>
                                                </CollectionView.ItemTemplate>
                                            </CollectionView>
                                            
                                            <!-- Add-ons List -->
                                            <CollectionView ItemsSource="{Binding Addons}" Margin="0,3,0,0">
                                                <CollectionView.ItemTemplate>
                                                    <DataTemplate>
                                                        <Label FontSize="12" TextColor="#666" Margin="0,1,0,1">
                                                            <Label.Text>
                                                                <MultiBinding StringFormat="- Add-ons: {0} ({1} {2} per serving)">
                                                                    <Binding Path="AddonName"/>
                                                                    <Binding Path="Amount"/>
                                                                    <Binding Path="Unit"/>
                                                                </MultiBinding>
                                                            </Label.Text>
                                                        </Label>
                                                    </DataTemplate>
                                                </CollectionView.ItemTemplate>
                                            </CollectionView>
                                        </VerticalStackLayout>
                                    </VerticalStackLayout>
                                    
                                    <!-- Completed Button -->
                                    <Button Grid.Column="1" Text="âœ“" FontSize="18" FontAttributes="Bold"
                                            BackgroundColor="#66BB6A" TextColor="White"
                                            CornerRadius="25" WidthRequest="50" HeightRequest="50" Padding="0"
                                            Command="{Binding BindingContext.CompleteItemCommand, Source={x:Reference Root}}"
                                            CommandParameter="{Binding .}"/>
                                </Grid>
                            </Frame>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </Grid>
        </Frame>
    </Grid>
</ContentView>


