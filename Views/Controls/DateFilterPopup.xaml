<?xml version="1.0" encoding="utf-8" ?>
<ContentView 
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="Coftea_Capstone.Views.Controls.DateFilterPopup"
    x:Name="DateFilterPopupView"
    BackgroundColor="#80000000"
    IsVisible="{Binding IsVisible}"
    InputTransparent="False">

    <Grid VerticalOptions="Fill" HorizontalOptions="Fill" InputTransparent="False">
        <!-- Background overlay that closes on tap -->
        <BoxView BackgroundColor="#80000000" InputTransparent="False" ZIndex="500">
            <BoxView.GestureRecognizers>
                <TapGestureRecognizer Command="{Binding CloseCommand}" />
            </BoxView.GestureRecognizers>
        </BoxView>

        <!-- Date Filter Popup -->
        <Frame BackgroundColor="White"
               CornerRadius="15"
               Padding="20"
               WidthRequest="350"
               MaximumHeightRequest="600"
               HorizontalOptions="Center"
               VerticalOptions="Center"
               HasShadow="True"
               InputTransparent="False"
               ZIndex="4000">
            <Grid RowDefinitions="Auto,*,Auto" RowSpacing="15" MinimumHeightRequest="500">
                <!-- Header -->
                <Grid Grid.Row="0" ColumnDefinitions="*,Auto">
                    <Label Text="ðŸ“… Select Date Range" 
                           FontSize="20" 
                           FontAttributes="Bold" 
                           TextColor="#5B4F45"
                           VerticalOptions="Center"/>
                    <Button Grid.Column="1" 
                            Text="âœ•" 
                            FontSize="18"
                            TextColor="#666666"
                            BackgroundColor="Transparent"
                            WidthRequest="30"
                            HeightRequest="30"
                            Command="{Binding CloseCommand}"/>
                </Grid>

                <!-- Content - Scrollable -->
                <ScrollView Grid.Row="1" 
                           Orientation="Vertical" 
                           VerticalScrollBarVisibility="Default"
                           VerticalOptions="FillAndExpand">
                    <VerticalStackLayout Spacing="20">
                    <!-- Quick Filters -->
                    <VerticalStackLayout Spacing="10">
                        <Label Text="Quick Filters" 
                               FontSize="14" 
                               FontAttributes="Bold" 
                               TextColor="#5B4F45"/>
                        <Grid ColumnDefinitions="*,*" ColumnSpacing="10" RowDefinitions="Auto,Auto,Auto" RowSpacing="10">
                            <Button Grid.Row="0" Grid.Column="0"
                                    Text="Today" 
                                    Command="{Binding SelectQuickFilterCommand}" 
                                    CommandParameter="Today"
                                    BackgroundColor="#E8F5E8"
                                    TextColor="#2E7D32"
                                    CornerRadius="8"
                                    HeightRequest="40"
                                    FontSize="13"
                                    FontAttributes="Bold"/>
                            <Button Grid.Row="0" Grid.Column="1"
                                    Text="Yesterday" 
                                    Command="{Binding SelectQuickFilterCommand}" 
                                    CommandParameter="Yesterday"
                                    BackgroundColor="#E8F5E8"
                                    TextColor="#2E7D32"
                                    CornerRadius="8"
                                    HeightRequest="40"
                                    FontSize="13"
                                    FontAttributes="Bold"/>
                            <Button Grid.Row="1" Grid.Column="0"
                                    Text="This Week" 
                                    Command="{Binding SelectQuickFilterCommand}" 
                                    CommandParameter="This Week"
                                    BackgroundColor="#E8F5E8"
                                    TextColor="#2E7D32"
                                    CornerRadius="8"
                                    HeightRequest="40"
                                    FontSize="13"
                                    FontAttributes="Bold"/>
                            <Button Grid.Row="1" Grid.Column="1"
                                    Text="This Month" 
                                    Command="{Binding SelectQuickFilterCommand}" 
                                    CommandParameter="This Month"
                                    BackgroundColor="#E8F5E8"
                                    TextColor="#2E7D32"
                                    CornerRadius="8"
                                    HeightRequest="40"
                                    FontSize="13"
                                    FontAttributes="Bold"/>
                            <Button Grid.Row="2" Grid.ColumnSpan="2"
                                    Text="All Dates" 
                                    Command="{Binding SelectQuickFilterCommand}" 
                                    CommandParameter="All Dates"
                                    BackgroundColor="#E8F5E8"
                                    TextColor="#2E7D32"
                                    CornerRadius="8"
                                    HeightRequest="40"
                                    FontSize="13"
                                    FontAttributes="Bold"/>
                        </Grid>
                    </VerticalStackLayout>

                    <!-- Custom Date Range -->
                    <VerticalStackLayout Spacing="10">
                        <Label Text="Custom Range" 
                               FontSize="14" 
                               FontAttributes="Bold" 
                               TextColor="#5B4F45"/>
                        <VerticalStackLayout Spacing="8">
                            <Label Text="Start Date" 
                                   FontSize="12" 
                                   TextColor="#666666"/>
                            <DatePicker x:Name="StartDatePicker"
                                       Date="{Binding StartDate, Mode=TwoWay}"
                                       MinimumDate="2020-01-01"
                                       MaximumDate="{Binding Today}"
                                       TextColor="#5B4F45"
                                       BackgroundColor="#F5F5F5"
                                       FontSize="14"
                                       DateSelected="OnStartDateSelected"/>
                        </VerticalStackLayout>
                        <VerticalStackLayout Spacing="8">
                            <Label Text="End Date" 
                                   FontSize="12" 
                                   TextColor="#666666"/>
                            <DatePicker x:Name="EndDatePicker"
                                       Date="{Binding EndDate, Mode=TwoWay}"
                                       MinimumDate="{Binding StartDate}"
                                       MaximumDate="{Binding Today}"
                                       TextColor="#5B4F45"
                                       BackgroundColor="#F5F5F5"
                                       FontSize="14"/>
                        </VerticalStackLayout>
                    </VerticalStackLayout>
                </VerticalStackLayout>
                </ScrollView>

                <!-- Footer Buttons -->
                <Grid Grid.Row="2" ColumnDefinitions="*,*" ColumnSpacing="10">
                    <Button Text="Cancel" 
                            Command="{Binding CloseCommand}"
                            BackgroundColor="#E0E0E0"
                            TextColor="#666666"
                            CornerRadius="8"
                            HeightRequest="45"/>
                    <Button Text="Apply" 
                            Command="{Binding ApplyDateFilterCommand}"
                            BackgroundColor="#2E7D32"
                            TextColor="White"
                            CornerRadius="8"
                            HeightRequest="45"/>
                </Grid>
            </Grid>
        </Frame>
    </Grid>
</ContentView>

