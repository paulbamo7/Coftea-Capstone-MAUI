<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Coftea_Capstone.Views.Controls.UserProfilePopup"
             xmlns:vm="clr-namespace:Coftea_Capstone.ViewModel.Controls"
             BackgroundColor="Transparent"
             IsVisible="{Binding IsVisible}">

    <ContentView.BindingContext>
        <vm:UserProfilePopupViewModel />
    </ContentView.BindingContext>

    <!-- Overlay Background -->
    <Grid BackgroundColor="#80000000" 
          VerticalOptions="FillAndExpand" 
          HorizontalOptions="FillAndExpand">
        <Grid.GestureRecognizers>
            <TapGestureRecognizer Command="{Binding CloseCommand}"/>
        </Grid.GestureRecognizers>
        
        <!-- Main Popup Container -->
        <Frame BackgroundColor="White"
               CornerRadius="20"
               HasShadow="True"
               BorderColor="#E0E0E0"
               Margin="40"
               VerticalOptions="Center"
               HorizontalOptions="Center"
               WidthRequest="800"
               MinimumHeightRequest="450">
            <Frame.GestureRecognizers>
                <TapGestureRecognizer/>
            </Frame.GestureRecognizers>
            
            <Grid RowDefinitions="Auto" ColumnDefinitions="*, *">
                
                <!-- Close Button - Top Right Corner -->
                <Button Text="âœ•"
                        BackgroundColor="Transparent"
                        TextColor="#666666"
                        FontSize="24" FontFamily="MontserratBlack"
                        FontAttributes="Bold"
                        Padding="0"
                        Grid.Row="0"
                        Grid.Column="1"
                        HorizontalOptions="End"
                        VerticalOptions="Start"
                        Margin="0,15,15,0"
                        WidthRequest="40"
                        HeightRequest="40"
                        CornerRadius="20"
                        Command="{Binding CloseCommand}"/>
                
                <!-- Left Section - Profile Picture and Name -->
                <Grid Grid.Row="0" Grid.Column="0" Padding="30" VerticalOptions="Center">
                    <VerticalStackLayout Spacing="20" HorizontalOptions="Center">
                        
                        <!-- Profile Picture -->
                        <Frame BackgroundColor="#F0F0F0"
                               CornerRadius="60"
                               WidthRequest="120"
                               HeightRequest="120"
                               HasShadow="True"
                               HorizontalOptions="Center"
                               IsClippedToBounds="True">
                            <Image Source="{Binding ProfileImageSource}"
                                   WidthRequest="120"
                                   HeightRequest="120"
                                   Aspect="AspectFill"
                                   HorizontalOptions="Fill"
                                   VerticalOptions="Fill"/>
                        </Frame>
                        
                        <!-- User Name -->
                        <Label Text="{Binding UserName}"
                               FontSize="24" FontFamily="MontserratBlack"
                               FontAttributes="Bold"
                               HorizontalOptions="Center"
                               TextColor="#000000"/>
                    </VerticalStackLayout>
                </Grid>
                
                <!-- Right Section - User Details -->
                <Grid Grid.Row="0" Grid.Column="1" Padding="30">
                    <VerticalStackLayout Spacing="15">
                        
                        <!-- Details Header -->
                        <Label Text="Details"
                               FontSize="24" FontFamily="MontserratBlack"
                               FontAttributes="Bold"
                               TextColor="#000000"
                               Margin="0,0,0,10"/>
                        
                        <!-- User Information -->
                        <VerticalStackLayout Spacing="8">
                            <Label Text="{Binding FullName, StringFormat='Full Name: {0}'}"
                                   FontSize="16" FontFamily="MontserratBlack"
                                   FontAttributes="Bold"
                                   TextColor="#000000"/>
                            
                            <Label Text="{Binding Email, StringFormat='Email: {0}'}"
                                   FontSize="16" FontFamily="MontserratBlack"
                                   FontAttributes="Bold"
                                   TextColor="#000000"/>
                            
                        </VerticalStackLayout>
                        
                        <!-- Access Section -->
                        <VerticalStackLayout Spacing="8" Margin="0,20,0,0">
                            <Label Text="Access"
                                   FontSize="20" FontFamily="MontserratBlack"
                                   FontAttributes="Bold"
                                   TextColor="#000000"
                                   Margin="0,0,0,5"/>
                            
                            <VerticalStackLayout Spacing="8">
                                <!-- Inventory Access -->
                                <Border StrokeThickness="2"
                                         StrokeShape="RoundRectangle 10"
                                         Padding="12,8"
                                         BackgroundColor="#E8E8E8"
                                         Stroke="#D0D0D0">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="BackgroundColor" Value="#E8E8E8" />
                                            <Setter Property="Stroke" Value="#D0D0D0" />
                                            <Style.Triggers>
                                                <DataTrigger TargetType="Border" Binding="{Binding CanEditInventory}" Value="True">
                                                    <Setter Property="BackgroundColor" Value="#8FA68E" />
                                                    <Setter Property="Stroke" Value="#7A9479" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <Label Text="{Binding InventoryAccessText}"
                                           FontSize="16" FontFamily="MontserratBlack"
                                           FontAttributes="Bold"
                                           TextColor="Black">
                                        <Label.Style>
                                            <Style TargetType="Label">
                                                <Setter Property="TextColor" Value="Black" />
                                                <Style.Triggers>
                                                    <DataTrigger TargetType="Label" Binding="{Binding CanEditInventory}" Value="True">
                                                        <Setter Property="TextColor" Value="White" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Label.Style>
                                    </Label>
                                </Border>
                                
                                <!-- POS Access -->
                                <Border StrokeThickness="2"
                                         StrokeShape="RoundRectangle 10"
                                         Padding="12,8"
                                         BackgroundColor="#E8E8E8"
                                         Stroke="#D0D0D0">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="BackgroundColor" Value="#E8E8E8" />
                                            <Setter Property="Stroke" Value="#D0D0D0" />
                                            <Style.Triggers>
                                                <DataTrigger TargetType="Border" Binding="{Binding CanEditPOSMenu}" Value="True">
                                                    <Setter Property="BackgroundColor" Value="#8FA68E" />
                                                    <Setter Property="Stroke" Value="#7A9479" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <Label Text="{Binding POSAccessText}"
                                           FontSize="16" FontFamily="MontserratBlack"
                                           FontAttributes="Bold"
                                           TextColor="Black">
                                        <Label.Style>
                                            <Style TargetType="Label">
                                                <Setter Property="TextColor" Value="Black" />
                                                <Style.Triggers>
                                                    <DataTrigger TargetType="Label" Binding="{Binding CanEditPOSMenu}" Value="True">
                                                        <Setter Property="TextColor" Value="White" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Label.Style>
                                    </Label>
                                </Border>
                                
                                <!-- Sales Report Access -->
                                <Border StrokeThickness="2"
                                         StrokeShape="RoundRectangle 10"
                                         Padding="12,8"
                                         BackgroundColor="#E8E8E8"
                                         Stroke="#D0D0D0">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="BackgroundColor" Value="#E8E8E8" />
                                            <Setter Property="Stroke" Value="#D0D0D0" />
                                            <Style.Triggers>
                                                <DataTrigger TargetType="Border" Binding="{Binding CanAccessSalesReport}" Value="True">
                                                    <Setter Property="BackgroundColor" Value="#8FA68E" />
                                                    <Setter Property="Stroke" Value="#7A9479" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <Label Text="{Binding SalesReportAccessText}"
                                           FontSize="16" FontFamily="MontserratBlack"
                                           FontAttributes="Bold"
                                           TextColor="Black">
                                        <Label.Style>
                                            <Style TargetType="Label">
                                                <Setter Property="TextColor" Value="Black" />
                                                <Style.Triggers>
                                                    <DataTrigger TargetType="Label" Binding="{Binding CanAccessSalesReport}" Value="True">
                                                        <Setter Property="TextColor" Value="White" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Label.Style>
                                    </Label>
                                </Border>
                            </VerticalStackLayout>
                        </VerticalStackLayout>
                    </VerticalStackLayout>
                </Grid>
            </Grid>
        </Frame>
    </Grid>
</ContentView>
